package main

import (
	"log"

	"github.com/csye7125-su24-team05/webapp-cve-consumer/internal/db"
	"github.com/csye7125-su24-team05/webapp-cve-consumer/internal/kafka"
)

func main() {
	CheckDBConection()
	CheckKafka()
}

func CheckDBConection() {
	db := db.NewDB()
	defer db.Close()
	err := db.Ping()
	if err != nil {
		log.Fatalf("%v", err.Error())
	}
}

func CheckKafka() {
	kafka := kafka.NewKafka()
	defer kafka.Close()
	err := kafka.CheckConnection()
	if err != nil {
		log.Fatalf("%v", err.Error())
	}
}